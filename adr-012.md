# ADR-012: Make **Agent Identity** a First-Class Pillar of Our Zero Trust Architecture

**Status:** Proposed
**Date:** October 28, 2025
**Owners:** Security Architecture / Platform Identity
**Deciders:** CISO, Chief Architect, Platform Security Lead
**Related:** ZTA Strategy, Agent Gateway, STS/Token Exchange, Policy-as-Code

---

## Context

Zero Trust requires that *every* request is authenticated, authorized, and continuously evaluated—no implicit trust based on network location. NIST defines ZTA as focusing on *users, assets, and resources*, shifting controls away from static perimeters. “Assets/resources” explicitly include services and workloads, not just people. In practice that means **non-person entities (NPEs)**—like AI agents, microservices, batch jobs, and automations—must have verifiable identities just like humans. ([NIST Computer Security Resource Center][1])

CISA’s Zero Trust Maturity Model 2.0 and federal ICAM guidance reinforce this: identity must cover **person and non-person entities**, and ICAM maturity is foundational to Zero Trust. ([CISA][2])

Our platform is introducing **autonomous and semi-autonomous agents** that (a) call APIs/tools, (b) chain to other agents, and (c) act *on behalf of* users or services. Without a first-class **Agent Identity**, we cannot: (1) enforce least privilege per hop, (2) bind actions to accountable principals, (3) express/verify delegation (user→agent→service), (4) revoke safely, or (5) achieve auditable provenance.

---

## Decision

**Adopt “Agent Identity” as a mandatory, first-class principal in our Zero Trust Architecture.** Concretely:

1. **Every agent is issued a verifiable workload identity** (SPIFFE SVID: X.509-SVID for mTLS and/or JWT-SVID for tokens). ([SPIFFE][3])
2. **All agent tokens are sender-constrained** (DPoP with `cnf`/JWK binding or mTLS certificate-bound tokens) to prevent replay and enforce possession. ([RFC Editor][4])
3. **Delegation uses OAuth 2.0 Token Exchange (RFC 8693)** with explicit *actor chain* (`act` / `may_act`) when an agent acts for a user or upstream service (“OBO”). ([RFC Editor][5])
4. **The Agent Gateway enforces session-aware policy** that continuously evaluates human identity + agent identity + context (device, workload posture, session risk) per request, aligned to NIST ZTA. ([NIST Publications][6])

---

## Rationale

* **ZTA Tenets:** NIST 800-207 requires authentication and authorization for every flow and treats services/workloads as resources—therefore identities for those principals are non-optional. ([NIST Publications][6])
* **NPE Coverage:** CISA ZTMM and federal ICAM explicitly include *non-person entities* in the identity pillar—formalizing the need for workload/agent identity. ([CISA][2])
* **Delegation & Accountability:** Token Exchange provides a standard way to model “on-behalf-of” with an auditable *actor chain*, avoiding opaque, untraceable bearer delegation. ([RFC Editor][5])
* **Replay Resistance:** DPoP and mTLS bind tokens to a key/cert; the `cnf` claim expresses proof-of-possession, reducing stolen-token abuse common with bearer tokens. ([RFC Editor][4])

---

## Scope

* **In scope:** All internal AI agents, automation jobs, headless services, and service accounts that call protected APIs, tools, data planes, or other agents.
* **Out of scope (for now):** Legacy batch jobs pinned to static shared secrets (must be migrated).

---

## Requirements (Must-Haves)

1. **Strong Agent Identity:** SPIFFE IDs (e.g., `spiffe://prod.acme/workspace/agent/foo`) and short-lived SVIDs (X.509 and/or JWT). ([SPIFFE][3])
2. **Sender-Constrained Tokens:**

   * DPoP (RFC 9449) with per-request signed proofs **or** mTLS (RFC 8705) certificate-bound access tokens; include `cnf` PoP claim when using JWT ATs (RFC 9068 + RFC 7800). ([IETF Datatracker][7])
3. **Delegation/OBO:** OAuth 2.0 **Token Exchange** (RFC 8693) at STS, emitting `act` / `may_act` claims to capture the actor chain. ([RFC Editor][5])
4. **Continuous Evaluation:** Policies evaluate {human identity, agent identity, tool/target resource, session risk, device/workload posture}. Align to NIST 800-207. ([NIST Publications][6])
5. **Revocation & Kill-Switch:** Central STS supports introspection and revocation of agent sessions/tokens; gateway fan-out revokes active sessions. (See OMB M-22-09 alignment for Zero Trust deadlines). ([The White House][8])
6. **Provenance & Audit:** Log actor chain, SVIDs used, DPoP `htm/htu/jti`, resource, decision, and policy version for each hop.

---

## Option Analysis

| Option                                     | Summary                                              | Pros                                                | Cons                                                            |
| ------------------------------------------ | ---------------------------------------------------- | --------------------------------------------------- | --------------------------------------------------------------- |
| **A. First-class Agent Identity (Chosen)** | SPIFFE SVIDs + sender-constrained OAuth; STS for OBO | Standardized, portable, replay-resistant, auditable | Requires SPIRE/STS rollout and key management                   |
| **B. Human-only Identity**                 | Attribute actions to end-user only                   | Simpler on paper                                    | Breaks least privilege; no workload provenance; weak audit      |
| **C. Shared Secrets / Static API Keys**    | Long-lived secrets for agents                        | Low initial friction                                | High breach blast radius; no delegation chain; no ZTA alignment |

---

## Consequences

* **Positive:**

  * Verifiable *who* (agent), *for whom* (actor chain), and *with what key* (DPoP/mTLS), per request.
  * Fine-grained authorization and policy decisions based on agent traits/capabilities.
  * Faster incident response via precise revocation of an agent/session without disrupting users.
* **Trade-offs:**

  * Engineering investment to deploy SPIRE (or equivalent), STS, and gateway enforcement.
  * Token exchange adds an extra hop—optimize caching and token TTLs.

---

## Security Considerations

* **Proof-of-Possession:** Use DPoP (app-layer) *or* mTLS (transport-layer) to mitigate stolen/brokered tokens; `cnf` claim binds JWT ATs to keys. ([RFC Editor][4])
* **Short-Lived Creds:** Prefer SVIDs and access tokens with brief TTLs; rotate aggressively. ([SPIFFE][9])
* **Delegation Semantics:** Use RFC 8693 `act` / `may_act` with audience scoping to avoid privilege inflation. ([RFC Editor][5])
* **Policy Drift:** Centralize policies; version and sign them; evaluate continuously per NIST ZTA. ([NIST Publications][6])

---

## Interoperability & Standards Mapping

* **ZTA Core:** NIST SP 800-207 / 207A. ([NIST Publications][6])
* **Identity Coverage:** CISA ZTMM 2.0 (NPE identity). ([CISA][2])
* **Workload Identity:** SPIFFE/SPIRE SVIDs. ([SPIFFE][3])
* **Tokens:** JWT ATs profile (RFC 9068); PoP `cnf` (RFC 7800). ([IETF Datatracker][10])
* **Sender Constraint:** DPoP (RFC 9449); mTLS (RFC 8705). ([IETF Datatracker][7])
* **Delegation/OBO:** OAuth 2.0 Token Exchange (RFC 8693). ([RFC Editor][5])

---

## Minimal Data Model (Agent Identity Record)

* `agent_id`: stable ID (e.g., `spiffe://<trust-domain>/<workload-id>`) ([SPIFFE][3])
* `keys`: active/public keys or cert refs (kid, thumbprints)
* `capabilities`: approved tools/APIs, scopes, rate limits
* `delegation_rules`: allowed `may_act` targets, max chain depth (RFC 8693) ([RFC Editor][5])
* `attestation`: workload posture (image digest, node attestation class)
* `lifecycle`: created/rotated/disabled timestamps

---

## Example: Delegated, Sender-Constrained Access (JWT AT excerpt)

```json
{
  "iss": "https://sts.example.com",
  "sub": "spiffe://prod.acme/agents/care-coordinator",
  "aud": "https://api.example.com",
  "scope": "appointments:write",
  "act": { "sub": "user:alice@example.com" },
  "cnf": { "jkt": "Eo1...thumbprint..." }, 
  "exp": 1730131200
}
```

* `act` conveys the **actor** (user) the agent is acting for (RFC 8693 §4.1) and `cnf.jkt` binds the token to the agent’s key/DPoP proofs (RFC 7800 / RFC 9449). ([RFC Editor][5])

---

## Operational Plan

1. **Workload Identity Fabric:** Deploy SPIRE across clusters; issue SVIDs to agents. ([SPIFFE][11])
2. **STS Enablement:** Stand up OAuth 2.0 Token Exchange with policy for `act/may_act`; log actor chains. ([RFC Editor][5])
3. **Sender Constraint:** Enable DPoP at the gateway for HTTP; mTLS for service-to-service where feasible. ([RFC Editor][4])
4. **Gateway Policy:** Evaluate (human + agent + context) each hop; deny if any principal missing or unverified per NIST ZTA. ([NIST Publications][6])
5. **Revocation:** Implement token introspection & kill-switch fan-out for agent sessions. (OMB M-22-09 alignment). ([The White House][8])

---

## Acceptance Criteria / KPIs

* 100% of agent calls present valid SVID and sender-constrained token.
* 0 successful replays of agent tokens in red-team tests (DPoP/mTLS enforced). ([RFC Editor][4])
* 100% delegated calls include actor chain evidence (`act`) with least-privilege scopes. ([RFC Editor][5])
* ≤5 minutes mean time to revoke a compromised agent across all sessions.

---

## Risks & Mitigations

* **Complex rollout:** Phase by environment; provide SDK/middleware.
* **Legacy compatibility:** Bridge with token exchange + gradually retire static keys. ([RFC Editor][5])
* **Performance:** Cache introspection and proof verification; favor short TTLs over heavy DB lookups.

---

## Alternatives Considered

* **Rely on human identity only:** Fails ZTA for workload principals; no provenance of agent actions. ([NIST Publications][6])
* **Opaque shared secrets/API keys:** Conflicts with least privilege & continuous verification; high blast radius.

---

## References

* NIST SP 800-207: *Zero Trust Architecture*. ([NIST Publications][6])
* NIST SP 800-207A: *ZTA Model for Cloud-Native Multi-Location Apps*. ([NIST Publications][12])
* CISA Zero Trust Maturity Model 2.0 (identity includes NPE). ([CISA][2])
* OMB M-22-09: *Federal Zero Trust Strategy*. ([The White House][8])
* SPIFFE/SPIRE SVID (workload identity). ([SPIFFE][3])
* OAuth 2.0 Token Exchange (RFC 8693): OBO/actor chain. ([RFC Editor][5])
* DPoP (RFC 9449): sender-constrained tokens. ([IETF Datatracker][7])
* OAuth 2.0 mTLS (RFC 8705): certificate-bound tokens. ([RFC Editor][13])
* JWT AT Profile (RFC 9068). ([IETF Datatracker][10])
* JWT PoP `cnf` (RFC 7800). ([IETF Datatracker][14])

---

**Bottom line:** In Zero Trust, *identity is the new perimeter*—and that includes agents. Making Agent Identity first-class enables least privilege, verifiable delegation, strong replay defenses, and precise incident response.

[1]: https://csrc.nist.gov/pubs/sp/800/207/final?utm_source=chatgpt.com "SP 800-207, Zero Trust Architecture | CSRC"
[2]: https://www.cisa.gov/sites/default/files/2023-04/zero_trust_maturity_model_v2_508.pdf?utm_source=chatgpt.com "Zero Trust Maturity Model Version 2.0"
[3]: https://spiffe.io/docs/latest/spiffe-about/overview/?utm_source=chatgpt.com "SPIFFE Overview"
[4]: https://www.rfc-editor.org/rfc/rfc9449.html?utm_source=chatgpt.com "OAuth 2.0 Demonstrating Proof of Possession (DPoP)"
[5]: https://www.rfc-editor.org/rfc/rfc8693.html?utm_source=chatgpt.com "RFC 8693: OAuth 2.0 Token Exchange"
[6]: https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-207.pdf?utm_source=chatgpt.com "Zero Trust Architecture - NIST Technical Series Publications"
[7]: https://datatracker.ietf.org/doc/rfc9449/?utm_source=chatgpt.com "OAuth 2.0 Demonstrating Proof of Possession (DPoP)"
[8]: https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf?utm_source=chatgpt.com "M-22-09 Federal Zero Trust Strategy"
[9]: https://spiffe.io/docs/latest/deploying/svids/?utm_source=chatgpt.com "Working with SVIDs"
[10]: https://datatracker.ietf.org/doc/html/rfc9068?utm_source=chatgpt.com "RFC 9068 - JSON Web Token (JWT) Profile for OAuth 2.0 ..."
[11]: https://spiffe.io/docs/latest/spire-about/spire-concepts/?utm_source=chatgpt.com "SPIRE Concepts"
[12]: https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-207A.pdf?utm_source=chatgpt.com "A Zero Trust Architecture Model for Access Control in Cloud ..."
[13]: https://www.rfc-editor.org/rfc/rfc8705.html?utm_source=chatgpt.com "RFC 8705: OAuth 2.0 Mutual-TLS Client Authentication ..."
[14]: https://datatracker.ietf.org/doc/html/rfc7800?utm_source=chatgpt.com "RFC 7800 - Proof-of-Possession Key Semantics for JSON ..."
