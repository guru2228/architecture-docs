# ADR-015: Mandate a **Session-Aware Agent Gateway** with Open-Protocol Support (MCP, A2A, AG-UI, ACP) for Zero-Trust Agentic Systems

**Status:** Proposed
**Date:** October 28, 2025
**Owners:** Platform Security, Agent Platform, Identity & Access
**Deciders:** CISO, Chief Architect, VP Eng (AI)
**Related:** ADR-012 Agent Identity, ADR-013 DPoP, ADR-014 OBO/Token Exchange

---

## Context

Zero Trust shifts protection from networks to **users, assets, and resources**; every request must be authenticated, authorized, and continuously evaluated—human and **non-person entities (agents/workloads)** alike. A “stateless” API gateway is insufficient for multi-hop agent workflows because risk and authorization hinge on **session context** (who/what is acting, for whom, with what tools, across which steps) that evolves during a task. ([NIST Computer Security Resource Center][1])

Modern agent stacks increasingly rely on **open protocols** so agents and tools interoperate safely across vendors and runtimes:

* **MCP (Model Context Protocol)** — standardized way for AI apps/agents to discover tools/resources and exchange typed context. ([Model Context Protocol][2])
* **A2A (Agent-to-Agent)** — emerging interop layer for agents to discover capabilities and collaborate across frameworks. ([A2A Protocol][3])
* **AG-UI (Agent–User Interaction)** — event-stream protocol so agents and UIs stay in sync with human-in-the-loop control. ([CopilotKit][4])
* **ACP (Agent Communication Protocol)** — REST/JSON messaging spec for cross-framework agent interop. ([Agent Communication Protocol][5])

These protocols are gaining traction (e.g., MCP support across the ecosystem, including platform vendors), reinforcing the need for **protocol-aware** controls at the gateway rather than bespoke, app-specific code. ([The Verge][6])

---

## Decision

**Adopt a Session-Aware Agent Gateway as the single policy enforcement point for all agent traffic**, with first-class support for open protocols (MCP, A2A, AG-UI, ACP) and Zero-Trust controls:

1. **Session as a security primitive.** Correlate human, workflow, agent, and protocol sessions (e.g., User-Session, Workflow-Session, Agent-Session, MCP-Session) and evaluate risk continuously per request/step. ([NIST Computer Security Resource Center][1])
2. **Strong identities everywhere.** Enforce **workload/agent identity** (e.g., SPIFFE/SPIRE SVIDs) and human identity on every hop. ([SPIFFE][7])
3. **Sender-constrained tokens.** Prefer **DPoP** or mTLS-bound tokens to prevent replay in browser, mobile, and cross-boundary calls. ([RFC Editor][8])
4. **Standards-based delegation.** Use **OAuth 2.0 Token Exchange (OBO)** to preserve and audit the **actor chain** (user → agent → tool/API). ([RFC Editor][9])
5. **Protocol-aware inspection & policy.** Understand MCP resource/tool calls, A2A capability exchange, AG-UI event streams, and ACP messages to apply least privilege, DLP, and step-up controls.

---

## Rationale

* **Zero Trust fit:** NIST ZTA requires continuous verification across **users and services/workloads**; a session-aware gateway is the control point that can actually combine identity, policy, and evolving task context. ([NIST Computer Security Resource Center][1])
* **Interoperability without lock-in:** Open protocols (MCP/A2A/AG-UI/ACP) are designed for **cross-vendor interop**; supporting them centrally prevents bespoke, duplicative security code in every app/agent. ([Model Context Protocol][2])
* **Safety & provenance:** OBO preserves end-user context; DPoP/mTLS stops token replay; protocol-aware logging yields end-to-end **actor chains** and tool provenance for audits and forensics. ([RFC Editor][9])
* **Ecosystem momentum:** MCP and related agent protocols are being adopted across OS and vendor ecosystems, signaling strategic durability. ([The Verge][6])

---

## Scope

* **In scope:** All agent traffic (north-south and east-west) using MCP, A2A, AG-UI, ACP; human-in-the-loop sessions; partner/third-party tools.
* **Out of scope (initial):** Legacy integrations that cannot emit protocol-compatible traffic (must migrate via shims).

---

## Requirements (Must-Haves)

1. **Identity & AuthN/Z**

   * SPIFFE/SPIRE SVIDs for agents/workloads; identity-aware policy. ([SPIFFE][7])
   * OAuth **Token Exchange (RFC 8693)** for OBO; audience-scoped, short-lived tokens. ([RFC Editor][9])
   * **DPoP (RFC 9449)** or **mTLS** for sender-constraint. ([RFC Editor][8])

2. **Session Model & Controls**

   * Correlate human, workflow, agent, and protocol session IDs; attach risk score; enforce step-up (re-auth, consent) on sensitive actions. (ZTA continuous evaluation). ([NIST Computer Security Resource Center][1])
   * **Kill-switch fan-out** to revoke agent sessions/tokens and terminate AG-UI/A2A/MCP/ACP streams.

3. **Protocol-Aware Enforcement**

   * **MCP:** Parse resource discovery, tool schemas, and calls; enforce allow-lists, schema-constrained inputs/outputs, rate limits, redaction/DLP. ([Model Context Protocol][2])
   * **A2A:** Validate agent capability cards/handshakes; constrain delegated scopes per actor; log inter-agent contracts. ([A2A Protocol][3])
   * **AG-UI:** Inspect SSE/WebSocket event streams; enforce human-in-the-loop gates and UI-side consent; throttle streaming. ([CopilotKit][4])
   * **ACP:** Validate message schema; apply content policy/DLP on multimodal payloads. ([Agent Communication Protocol][5])

4. **Observability & Audit**

   * Structured logs for `who` (user/agent), `for whom` (actor chain), `what` (tool/capability), `where` (audience/resource), `how` (DPoP/mTLS), decision & policy version.

---

## Option Analysis

| Option                                      | Summary                                              | Pros                                            | Cons                                                           |
| ------------------------------------------- | ---------------------------------------------------- | ----------------------------------------------- | -------------------------------------------------------------- |
| **A. Session-Aware Agent Gateway (Chosen)** | Protocol-aware, identity-rich, continuous evaluation | ZTA-aligned; interoperable; strong auditability | New infra; needs protocol adapters                             |
| **B. Traditional API Gateway**              | Stateless request router with coarse auth            | Simpler, familiar ops                           | Lacks session/risk awareness; cannot interpret agent protocols |
| **C. Library-only approach**                | Push checks into each agent/app                      | Flexible                                        | Duplicated effort; inconsistent policy; weak central audit     |

---

## Security Considerations

* **Replay & theft:** Enforce **DPoP/mTLS** and reject bearer-only use of bound tokens. ([RFC Editor][8])
* **Delegation safety:** Use **RFC 8693** `act/may_act` semantics; bound to narrowly scoped audiences; short TTLs. ([RFC Editor][9])
* **Tool/data egress:** For MCP/ACP, enforce schema-level allow/deny, redact secrets, and apply output filtering/DLP. ([Model Context Protocol][2])
* **Human-in-the-loop:** For AG-UI streams, require explicit user consent prompts and reversible actions; block unsafe tool calls pending approval. ([CopilotKit][4])

---

## Operational Plan

1. **Deploy Identity Fabric:** Roll out SPIRE across clusters; issue SVIDs to agents/services. ([SPIFFE][7])
2. **Enable STS:** Stand up **Token Exchange** (OBO) and **DPoP** issuance/validation paths; advertise in AS metadata. ([RFC Editor][9])
3. **Protocol Adapters:**

   * MCP server/client interception; schema cache; tool registry. ([Model Context Protocol][2])
   * A2A capability discovery and handshake validator. ([A2A Protocol][3])
   * AG-UI SSE/WebSocket guardrail middleware. ([CopilotKit][4])
   * ACP message validator & content filters. ([Agent Communication Protocol][5])
4. **Session Graph:** Persist correlated session IDs and actor chains; surface to SecOps; wire kill-switches to terminate active streams and revoke tokens.
5. **Policies-as-Code:** Managed repository for allow-lists, scopes, and risk rules; versioned and signed.

---

## Acceptance Criteria / KPIs

* ≥95% of agent/tool calls traverse the gateway with **actor chain present** (OBO). ([RFC Editor][9])
* **0** successful token-replay events in red-team tests (DPoP/mTLS enforced). ([RFC Editor][8])
* 100% MCP/A2A/AG-UI/ACP traffic inspected with protocol-aware policies applied. ([Model Context Protocol][2])
* Mean time to kill an agent session (all streams + tokens) **≤5 minutes**.

---

## Non-Goals

* Mandating a single agent framework. The gateway **abstracts protocols**, not runtimes.
* Inspecting LLM internals. We govern **IO and context**, not model weights.

---

## References

* **NIST SP 800-207**: Zero Trust Architecture (focus on users, assets, resources; continuous evaluation). ([NIST Computer Security Resource Center][1])
* **MCP (Model Context Protocol)** — official docs & spec. ([Model Context Protocol][2])
* **A2A (Agent-to-Agent)** — specification & Linux Foundation announcement. ([A2A Protocol][3])
* **AG-UI (Agent–User Interaction)** — protocol overview & docs. ([CopilotKit][4])
* **ACP (Agent Communication Protocol)** — overview/spec site. ([Agent Communication Protocol][5])
* **OAuth 2.0 Token Exchange (RFC 8693)** — OBO/delegation. ([RFC Editor][9])
* **DPoP (RFC 9449)** — sender-constrained tokens. ([RFC Editor][8])

---

**Bottom line:** A **session-aware, protocol-smart gateway** is essential to implement Zero Trust for agentic systems—uniting identity, delegation, and continuous, step-level policy across MCP/A2A/AG-UI/ACP so we get secure interoperability **without** vendor lock-in.

[1]: https://csrc.nist.gov/pubs/sp/800/207/final?utm_source=chatgpt.com "SP 800-207, Zero Trust Architecture | CSRC"
[2]: https://modelcontextprotocol.io/?utm_source=chatgpt.com "What is the Model Context Protocol (MCP)? - Model Context ..."
[3]: https://a2a-protocol.org/latest/specification/?utm_source=chatgpt.com "Specification - A2A Protocol"
[4]: https://www.copilotkit.ai/ag-ui?utm_source=chatgpt.com "AG-UI: The Agent ↔ User Interaction Protocol"
[5]: https://agentcommunicationprotocol.dev/introduction/welcome?utm_source=chatgpt.com "Agent Communication Protocol: Welcome"
[6]: https://www.theverge.com/news/669298/microsoft-windows-ai-foundry-mcp-support?utm_source=chatgpt.com "Windows is getting support for the 'USB-C of AI apps'"
[7]: https://spiffe.io/docs/latest/spiffe-about/overview/?utm_source=chatgpt.com "SPIFFE Overview"
[8]: https://www.rfc-editor.org/rfc/rfc9449.html?utm_source=chatgpt.com "OAuth 2.0 Demonstrating Proof of Possession (DPoP)"
[9]: https://www.rfc-editor.org/rfc/rfc8693.html?utm_source=chatgpt.com "RFC 8693: OAuth 2.0 Token Exchange"
